{"version":3,"file":"backed.js","sources":["../src/utils.js","../src/internals/fire-event.js","../src/internals/to-js-prop.js","../src/internals/pub-sub.js","../src/internals/pub-sub-loader.js","../src/backed.js","../src/index.js"],"sourcesContent":["'use strict';\n// import Bind from './bind.js';\n\nconst handleProperties = (target, properties) => {\n  if (properties) {\n    for (let property of Object.keys(properties)) {\n      const observer = properties[property].observer;\n      const strict = properties[property].strict;\n      handlePropertyObserver(target, property, strict, observer);\n      // Bind(superclass, superclass.properties)\n    }\n  }\n}\n\nconst handlePropertyObserver = (obj, property, strict, observer) => {\n  if (observer && _needsObserverSetup(obj, property)) {\n    obj.observedProperties.push(property);\n    setupObserver(obj, property, strict, observer)\n  }\n}\n\nconst _needsObserverSetup = (obj, property) => {\n  if (!obj.observedProperties) {\n    obj.observedProperties = [];\n  }\n  if (obj.observedProperties[property]) {\n    console.warn(\n      'observer::ignoring duplicate property observer ' + property\n    );\n    return false;\n  } else {\n    return true;\n  }\n}\n\n/**\n * Runs a method on target whenever given property changes\n *\n * example:\n * change(change) {\n *  change.property // name of the property\n *  change.value // value of the property\n * }\n *\n * @arg {object} obj target\n * @arg {string} property name\n * @arg {boolean} strict\n * @arg {method} fn The method to run on change\n */\nconst setupObserver = (obj, property, strict=false, fn) => {\n  Object.defineProperty(obj, property, {\n    set(value) {\n      let data = {\n        property: property,\n        value: value\n      };\n      this[fn](data);\n      PubSub.publish(fn, data);\n    },\n    configurable: strict ? false : true\n  });\n}\n\n\nconst handleObservers = (obj, observers) => {\n  if (!observers) {\n    return;\n  }\n  for (let observe of observers) {\n    let parts = observe.split(/\\(|\\)/g);\n    let fn = parts[0];\n    parts = parts.slice(1);\n    for (property of parts) {\n      if (property.length) {\n        handlePropertyObserver(obj, property, false, fn);\n      }\n    }\n  }\n}\n\nexport default {\n  handleProperties: handleProperties.bind(this),\n  handlePropertyObserver: handlePropertyObserver.bind(this),\n  handleObservers: handleObservers.bind(this),\n  setupObserver: setupObserver.bind(this)\n}\n","'use strict';\n/**\n * @mixin backed\n * @param {string} type Name of the event\n * @param {HTMLElement} target Name of the event\n * @param {string|boolean|number|object|array} detail\n */\nexport default (type=String, detail=null, target=document) => {\n  target.dispatchEvent(new CustomEvent(type, {detail: detail}));\n};\n","'use strict';\n/**\n * @mixin Backed\n *\n * some-prop -> someProp\n *\n * @arg {string} string The content to convert\n * @return {string} string\n */\nexport default string => {\n  let parts = string.split('-');\n  if (parts.length > 1) {\n    var upper = parts[1].charAt(0).toUpperCase();\n    string = parts[0] + upper + parts[1].slice(1).toLowerCase();\n  }\n  return string;\n};\n","'use strict';\r\nexport default class {\r\n\r\n  /**\r\n   * Creates handlers\r\n   */\r\n  constructor() {\r\n    this.handlers = [];\r\n  }\r\n\r\n  /**\r\n   * @param {String} event\r\n   * @param {Method} handler\r\n   * @param {HTMLElement} context\r\n   */\r\n  subscribe(event, handler, context) {\r\n    if (typeof context === 'undefined') {\r\n      context = handler;\r\n    }\r\n    this.handlers.push({event: event, handler: handler.bind(context)});\r\n  }\r\n\r\n  /**\r\n   * @param {String} event\r\n   * @param {String|Number|Boolean|Object|Array} value\r\n   */\r\n  publish(event, value) {\r\n    for (let i = 0; i < this.handlers.length; i++) {\r\n      if (this.handlers[i].event === event) {\r\n        this.handlers[i].handler(event, value, this.handlers[i].oldValue);\r\n        this.handlers[i].oldValue = value;\r\n      }\r\n    }\r\n  }\r\n}\r\n","'use strict';\r\nimport Pubsub from './pub-sub.js';\r\nexport default () => {\r\n  window.PubSub = window.PubSub || new Pubsub();\r\n}\r\n","'use strict';\nimport Utils from './utils';\nimport fireEvent from './internals/fire-event.js';\nimport toJsProp from './internals/to-js-prop.js';\nimport PubSubLoader from './internals/pub-sub-loader.js';\nPubSubLoader();\n\n/**\n *\n * @module backed\n * @arg {class} _class\n */\nexport default _class => {\n  const upperToHyphen = string => {\n    return string.replace(/([A-Z])/g, \"-$1\").toLowerCase().replace('-', '');\n  }\n\n  // get the tagName or try to make one with class.name\n  let name = _class.is || upperToHyphen(_class.name);\n  // Setup properties & mixins\n  // define/register custom-element\n  customElements.define(name, class extends _class {\n    constructor() {\n      super();\n      this.fireEvent = fireEvent.bind(this);\n      this.toJsProp = toJsProp.bind(this);\n\n      Utils.handleProperties(this, _class.properties);\n      Utils.handleObservers(this, _class.observers);\n    }\n  });\n};\n","'use strict';\nimport Backed from './backed.js';\n\nwindow.Backed = window.Backed || new Backed();\n"],"names":["this"],"mappings":"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"}