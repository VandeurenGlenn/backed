{"version":3,"file":"backed-es.js","sources":["../src/internals/fire-event.js","../src/internals/to-js-prop.js","../src/internals/load-script.js","../src/internals/pub-sub.js","../src/internals/pub-sub-loader.js","../src/base.js","../src/backed.js"],"sourcesContent":["'use strict';\r\n/**\r\n * @mixin backed\r\n * @param {string} type Name of the event\r\n * @param {HTMLElement} target Name of the event\r\n * @param {string|boolean|number|object|array} detail\r\n */\r\nexport default (type=String, detail=null, target=document) => {\r\n  target.dispatchEvent(new CustomEvent(type, {detail: detail}));\r\n};\r\n","'use strict';\r\n/**\r\n * @mixin Backed\r\n *\r\n * some-prop -> someProp\r\n *\r\n * @arg {string} string The content to convert\r\n * @return {string} string\r\n */\r\nexport default string => {\r\n  let parts = string.split('-');\r\n  if (parts.length > 1) {\r\n    var upper = parts[1].charAt(0).toUpperCase();\r\n    string = parts[0] + upper + parts[1].slice(1).toLowerCase();\r\n  }\r\n  return string;\r\n};\r\n","'use strict';\nconst loadScript = src => {\n  return new Promise((resolve, reject) => {\n    let script = document.createElement('script');\n    script.src = src;\n    script.onload = result => {\n      resolve(result);\n    }\n    script.onerror = error => {\n      reject(error);\n    }\n    document.body.appendChild(script);\n  });\n}\nexport default loadScript;\n","'use strict';\r\nexport default class {\r\n\r\n  /**\r\n   * Creates handlers\r\n   */\r\n  constructor() {\r\n    this.handlers = [];\r\n  }\r\n\r\n  /**\r\n   * @param {String} event\r\n   * @param {Method} handler\r\n   * @param {HTMLElement} context\r\n   */\r\n  subscribe(event, handler, context) {\r\n    if (typeof context === 'undefined') {\r\n      context = handler;\r\n    }\r\n    this.handlers.push({event: event, handler: handler.bind(context)});\r\n  }\r\n\r\n  /**\r\n   * @param {String} event\r\n   * @param {String|Number|Boolean|Object|Array} change\n   */\r\n  publish(event, change) {\n    for (let i = 0; i < this.handlers.length; i++) {\r\n      if (this.handlers[i].event === event) {\n        let oldValue = this.handlers[i].oldValue;\n        // dirty checking value, ensures that we don't create a loop\n        if (oldValue !== change.value) {\n          this.handlers[i].handler(change, this.handlers[i].oldValue);\n          this.handlers[i].oldValue = change.value;\n        }\n      }\r\n    }\r\n  }\r\n}\r\n","'use strict';\r\nimport Pubsub from './pub-sub.js';\nexport default isWindow => {\n  if (isWindow) {\n    window.PubSub = window.PubSub || new Pubsub();\n  } else {\n    global.PubSub = global.PubSub || new Pubsub();\n  }\n}\r\n","'use strict';\nimport fireEvent from './internals/fire-event.js';\nimport toJsProp from './internals/to-js-prop.js';\nimport loadScript from './internals/load-script.js';\nimport PubSubLoader from './internals/pub-sub-loader.js';\n\nconst shouldShim = () => {\n  return /Edge/.test(navigator.userAgent) || /Firefox/.test(navigator.userAgent);\n}\n\nconst setupTemplate = ({ name: name, shady: shady }) => {\n  try {\n    const ownerDocument = document.currentScript.ownerDocument;\n    const template = ownerDocument.querySelector(`template[id=\"${name}\"]`);\n    if (template) {\n      if (shady) {\n        ShadyCSS.prepareTemplate(template, name);\n      }\n      return template;\n    }\n  } catch (e) {\n    return console.warn(e);\n  }\n}\n\nconst handleShadowRoot = ({ target: target, template: template }) => {\n  if (!target.shadowRoot) {\n    target.attachShadow({mode: 'open'});\n    if (template) {\n      target.shadowRoot.appendChild(\n        document.importNode(template.content, true));\n\n        if (shouldShim()) {\n          const styles = target.shadowRoot.querySelectorAll('style');\n          let _shimmed;\n          if (styles[0]) {\n            _shimmed = document.createElement('style');\n            target.shadowRoot.insertBefore(_shimmed, target.shadowRoot.firstChild);\n          }\n          for (let style of styles) {\n            _shimmed.innerHTML += style.innerHTML\n              .replace(/:host\\b/gm, target.localName)\n              .replace(/::content\\b/gm, '');\n\n            target.shadowRoot.removeChild(style);\n          }\n        }\n    }\n  }\n}\n\nconst handleProperties = (target, properties) => {\r\n  if (properties) {\r\n    for (let property of Object.keys(properties)) {\r\n      const observer = properties[property].observer;\r\n      const strict = properties[property].strict;\r\n      const isGlobal = properties[property].global;\r\n      handlePropertyObserver(target, property, observer, {\r\n        strict: strict || false,\r\n        global: isGlobal || false\r\n      });\n      target[property] = properties[property].value;\n      // Bind(superclass, superclass.properties)\r\n    }\r\n  }\r\n}\r\n\r\nconst handlePropertyObserver = (obj, property, observer, opts={\r\n  strict: false, global:false\r\n}) => {\r\n\r\n  if (observer && _needsObserverSetup(obj, property)) {\r\n    obj.observedProperties.push(property);\r\n\n    // subscribe only when a callback is defined, all other global options are still available ...\n    if (opts.global && obj[observer]) {\n      PubSub.subscribe(`global.${property}`, obj[observer].bind(obj));\n    }\r\n    setupObserver(obj, property, observer, opts)\r\n  }\r\n}\r\n\r\nconst _needsObserverSetup = (obj, property) => {\r\n  if (!obj.observedProperties) {\r\n    obj.observedProperties = [];\r\n  }\r\n  if (obj.observedProperties[property]) {\r\n    console.warn(\r\n      'observer::ignoring duplicate property observer ' + property\r\n    );\r\n    return false;\r\n  } else {\r\n    return true;\r\n  }\r\n}\r\n\r\nconst forObservers = (target, observers, isGlobal=false) => {\r\n  for (let observe of observers) {\r\n    let parts = observe.split(/\\(|\\)/g);\r\n    let fn = parts[0];\r\n    parts = parts.slice(1);\r\n    for (let property of parts) {\r\n      if (property.length) {\r\n        handlePropertyObserver(target, property, fn, {\r\n          strict: false,\r\n          global: isGlobal\r\n        });\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * Runs a method on target whenever given property changes\r\n *\r\n * example:\r\n * change(change) {\r\n *  change.property // name of the property\r\n *  change.value // value of the property\r\n * }\r\n *\r\n * @arg {object} obj target\r\n * @arg {string} property name\r\n * @arg {boolean} strict\r\n * @arg {method} fn The method to run on change\r\n */\r\nconst setupObserver = (obj, property, fn, opts={\r\n  strict: false, global: false\r\n}) => {\n  const isConfigurable = opts.strict ? false : true;\n  Object.defineProperty(obj, property, {\r\n    set(value) {\n      if (this[`_${property}`] === value) {\n        return;\n      }\n      this[`_${property}`] = value;\r\n      let data = {\r\n        property: property,\r\n        value: value\r\n      };\r\n      if (opts.global) {\r\n        data.instance = this;\r\n        PubSub.publish(`global.${property}`, data);\r\n      } else {\r\n        this[fn](data);\r\n      }\r\n    },\r\n    get() {\r\n      return this[`_${property}`];\r\n    },\r\n    configurable: isConfigurable\n  });\r\n}\r\n\r\n\r\nconst handleObservers = (target, observers=[], globalObservers=[]) => {\r\n  if (!observers && !globalObservers) {\r\n    return;\r\n  }\r\n  forObservers(target, observers);\r\n}\n\nconst ready = target => {\n  requestAnimationFrame(() => {\n    if (target.ready) target.ready();\n  });\n}\n\nconst constructorCallback = (target=HTMLElement, hasWindow=false, shady) => {\n  PubSubLoader(hasWindow);\n\n  if (shady) {\n    ShadyCSS.styleElement(target)\n  }\n\n  target.fireEvent = fireEvent.bind(target);\n  target.toJsProp = toJsProp.bind(target);\n  target.loadScript = loadScript.bind(target);\n\n  // let backed know the element is registered\n  target.registered = true;\n\n  if (!target.registered && target.created) target.created();\n}\n\nconst connectedCallback = (target=HTMLElement, klass=Function, template=null) => {\n  handleShadowRoot({target: target, template: template});\n  if (target.connected) target.connected();\n  // setup properties\n  handleProperties(target, klass.properties);\n  // setup properties\n  handleObservers(target, klass.observers, klass.globalObservers);\n  // notify everything is ready\n  ready(target);\n}\n\r\nexport default {\n  setupTemplate: setupTemplate.bind(this),\n  handleShadowRoot: handleShadowRoot.bind(this),\n  handleProperties: handleProperties.bind(this),\r\n  handlePropertyObserver: handlePropertyObserver.bind(this),\r\n  handleObservers: handleObservers.bind(this),\r\n  setupObserver: setupObserver.bind(this),\n  ready: ready.bind(this),\n  connectedCallback: connectedCallback.bind(this),\n  constructorCallback: constructorCallback.bind(this)\n}\n","'use strict';\r\nimport base from './base.js';\nconst supportsCustomElementsV1 = 'customElements' in window;\r\nconst supportsCustomElementsV0 = 'registerElement' in document;\nconst supportsShadowDOMV1 = !!HTMLElement.prototype.attachShadow;\n\r\nconst isWindow = () => {\r\n  try {\r\n    return window;\r\n  } catch(e) {\r\n    return false;\r\n  }\r\n};\r\n\nconst hasWindow = isWindow();\n\n/**\r\n *\r\n * @module backed\r\n * @param {class} _class\r\n */\r\nexport default _class => {\r\n  const upperToHyphen = string => {\r\n    return string.replace(/([A-Z])/g, \"-$1\").toLowerCase().replace('-', '');\r\n  };\r\n\r\n  let klass;\r\n\r\n  // get the tagName or try to make one with class.name\r\n  let name = _class.is || upperToHyphen(_class.name);\r\n\r\n  // Setup properties & observers\r\n  if (hasWindow) {\n    const template = base.setupTemplate({\n      name: name,\n      shady: !supportsShadowDOMV1\n    });\n\n    if (supportsCustomElementsV1) {\n      klass = class extends _class {\r\n        constructor() {\n          super();\n          base.constructorCallback(this, hasWindow, !supportsShadowDOMV1);\n        }\n        connectedCallback() {\n          base.connectedCallback(this, _class, template);\n        }\n        disconnectedCallback() {\n          if (this.disconnected) this.disconnected();\n        }\n      }\r\n      customElements.define(name, klass);\n    } else if (supportsCustomElementsV0) {\r\n      klass = document.registerElement(name, class extends _class {\r\n        createdCallback() {\n          base.constructorCallback(this, hasWindow, !supportsShadowDOMV1);\n        }\n        attachedCallback() {\n          base.connectedCallback(this, _class, template);\n        }\n        detachedCallback() {\n          if (this.disconnected) this.disconnected();\n        }\n        attachShadow() {\r\n          // TODO: feature detect shadowDOM for V1\r\n          return this.createShadowRoot();\r\n        }\r\n      })\r\n    } else {\r\n      console.warn('classes::unsupported');\r\n    }\r\n  } else {\n    // TODO: handle Commonjs (properties, observers, etc ...)\n    klass = _class;\r\n  }\n  return klass;\r\n};\r\n"],"names":["type","String","detail","target","document","dispatchEvent","CustomEvent","string","parts","split","length","upper","charAt","toUpperCase","slice","toLowerCase","loadScript","src","Promise","resolve","reject","script","createElement","onload","result","onerror","error","body","appendChild","handlers","event","handler","context","push","bind","change","i","oldValue","value","isWindow","PubSub","window","Pubsub","global","shouldShim","test","navigator","userAgent","setupTemplate","name","shady","ownerDocument","currentScript","template","querySelector","prepareTemplate","e","console","warn","handleShadowRoot","shadowRoot","attachShadow","mode","importNode","content","styles","querySelectorAll","_shimmed","insertBefore","firstChild","style","innerHTML","replace","localName","removeChild","handleProperties","properties","property","Object","keys","observer","strict","isGlobal","handlePropertyObserver","obj","opts","_needsObserverSetup","observedProperties","subscribe","forObservers","observers","observe","fn","setupObserver","isConfigurable","defineProperty","data","instance","publish","handleObservers","globalObservers","ready","constructorCallback","HTMLElement","hasWindow","styleElement","fireEvent","toJsProp","registered","created","connectedCallback","klass","Function","connected","this","supportsCustomElementsV1","supportsCustomElementsV0","supportsShadowDOMV1","prototype","_class","upperToHyphen","is","base","disconnected","define","registerElement","createShadowRoot"],"mappings":"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"}